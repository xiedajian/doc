[å‚è€ƒ](https://juejin.im/post/5c94fef7f265da60fd0c15e8)

 # ä»€ä¹ˆæ˜¯CLI
CLIï¼ˆcommand-line interface å‘½ä»¤è¡Œç•Œé¢ï¼‰æ˜¯æŒ‡åœ¨å›¾å½¢ç”¨æˆ·ç•Œé¢å¾—åˆ°æ™®åŠä¹‹å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„ç”¨æˆ·ç•Œé¢ï¼Œå®ƒé€šå¸¸ä¸æ”¯æŒé¼ æ ‡ï¼Œ

ç”¨æˆ·é€šè¿‡é”®ç›˜è¾“å…¥æŒ‡ä»¤ï¼Œè®¡ç®—æœºæ¥æ”¶åˆ°æŒ‡ä»¤åï¼Œäºˆä»¥æ‰§è¡Œã€‚ä¹Ÿæœ‰äººç§°ä¹‹ä¸ºå­—ç¬¦ç”¨æˆ·ç•Œé¢ï¼ˆCUIï¼‰

æ‰¯äº†ä¸€å †ï¼Œä½ å¥½åƒè¿˜æ²¡è¯´ä¸‹å•¥æ˜¯è„šæ‰‹æ¶ï¼Ÿemmm... å®ƒå°±æ˜¯ä¸ªå·¥å…·ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ–°å»ºé¡¹ç›®ç”¨çš„ï¼Œæœ‰äº†è¿™ä¸ªé¡¹ç›®æˆ‘ä»¬å°±èƒ½ç›´æ¥å¼€å‘äº†ã€‚

å…¶å®æˆ‘ä»¬æœ¬å¯ä»¥ç”¨ git clone url æ¥æ–°å»ºï¼ˆå¤åˆ¶ï¼‰é¡¹ç›®ï¼Œå† cuo ä¸€ç‚¹çš„æ–¹æ³•å°±æ˜¯å¤åˆ¶ç²˜è´´æ•´ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€æ ·ä¹Ÿèƒ½è¾¾åˆ°åˆå§‹åŒ–çš„ç›®çš„ã€‚

è„šæ‰‹æ¶çš„æœ¬è´¨ä¹Ÿæ˜¯ä»è¿œç¨‹ä¸‹è½½ä¸€ä¸ªæ¨¡æ¿æ¥è¿›è¡Œä¸€ä¸ªæ–°é¡¹ç›®ã€‚é¢ã€‚æ‰€ä»¥ã€‚ã€‚ã€‚æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿå°±é«˜å¤§ä¸Šå•Š

å½“ç„¶ä¸æ­¢äºæ­¤å•¦ï¼Œè„šæ‰‹æ¶å¯æ˜¯é«˜çº§ç‰ˆçš„å…‹éš†ï¼Œå®ƒä¸»è¦æ˜¯æä¾›äº†äº¤äº’å¼çš„å‘½ä»¤è®©æˆ‘ä»¬å¯ä»¥åŠ¨æ€çš„æ›´æ”¹æ¨¡æ¿ï¼Œ

ç„¶åç”¨ä¸€å¥å‘½ä»¤å°±å¯ä»¥ä¸€åŠ³æ°¸é€¸äº†ï¼ˆå½“ç„¶è¿˜æ˜¯è¦ç»´æŠ¤çš„ï¼‰ï¼Œè¿™åº”è¯¥æ˜¯æœ€ä¸»è¦çš„åŒºåˆ«å§ï¼Œåæ­£ç°åœ¨æˆ‘æ˜¯è¿™ä¹ˆæƒ³çš„ğŸ˜¢ã€‚


# å‰ç½®çŸ¥è¯†


## commander

è¿™æ˜¯ç”¨æ¥ç¼–å†™æŒ‡ä»¤å’Œå¤„ç†å‘½ä»¤è¡Œçš„ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š
```
const program = require("commander");
// å®šä¹‰æŒ‡ä»¤
program
  .version('0.0.1')
  .command('init', 'Generate a new project from a template')
  .action(() => {
    // å›è°ƒå‡½æ•°
  })
// è§£æå‘½ä»¤è¡Œå‚æ•°
program.parse(process.argv);

```

å›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ›¾ç”¨è¿‡çš„ vue init çš„å‘½ä»¤å°±æ˜¯è¿™æ ·å£°æ˜çš„ã€‚


## inquirer

è¿™æ˜¯ä¸ªå¼ºå¤§çš„äº¤äº’å¼å‘½ä»¤è¡Œå·¥å…·ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š

æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬ç”¨ vue init webpack project-name ä¹‹åæ˜¯ä¸æ˜¯ä¼šæœ‰å‡ ä¸ªäº¤äº’é—®é¢˜ï¼Œé—®ä½ æ–‡ä»¶åå•Šã€ä½œè€…å•Šã€æè¿°å•Šã€è¦ä¸è¦ç”¨ eslint å•Šç­‰ç­‰ä¹‹ç±»çš„ï¼Œå°±æ˜¯ç”¨è¿™ä¸ªæ¥å†™çš„ã€‚



## chalk

è¿™æ˜¯ç”¨æ¥ä¿®æ”¹æ§åˆ¶å°è¾“å‡ºå†…å®¹æ ·å¼çš„ï¼Œæ¯”å¦‚é¢œè‰²å•Šï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š
```
const chalk = require('chalk');
console.log(chalk.green('success'));
console.log(chalk.red('error'));
```


## ora

è¿™æ˜¯ä¸€ä¸ªå¥½çœ‹çš„åŠ è½½ï¼Œå°±æ˜¯ä½ ä¸‹è½½çš„æ—¶å€™ä¼šæœ‰ä¸ªè½¬åœˆåœˆçš„é‚£ç§æ•ˆæœï¼Œç”¨æ³•å¦‚ä¸‹ï¼š
```
const ora = require('ora')
let spinner = ora('downloading template ...')
spinner.start()
```


## download-git-repo

çœ‹åå­—å¾ˆæ˜æ˜¾äº†ï¼Œè¿™æ˜¯ç”¨æ¥ä¸‹è½½è¿œç¨‹æ¨¡æ¿çš„ï¼Œæ”¯æŒ GitHubã€ GitLab å’Œ Bitbucket ç­‰ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š

```
const download = require('download-git-repo')
download(repository, destination, options, callback)
```

å…¶ä¸­ repository æ˜¯è¿œç¨‹ä»“åº“åœ°å€ï¼›destination æ˜¯å­˜æ”¾ä¸‹è½½çš„æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™æ–‡ä»¶åï¼Œé»˜è®¤å°±æ˜¯å½“å‰ç›®å½•ï¼›options æ˜¯ä¸€äº›é€‰é¡¹ï¼Œæ¯”å¦‚ { cloneï¼šboolean } è¡¨ç¤ºç”¨ http download è¿˜æ˜¯ git clone çš„å½¢å¼ä¸‹è½½ã€‚




# å®æˆ˜


### 1


è¿›å…¥å¼€å‘ç›®å½•ï¼Œæ‰§è¡Œ
```
npm init -y
```
å°†ä¼šåˆ›å»º package.jsonå’Œé»˜è®¤çš„é…ç½®ã€‚å½“ç„¶æ‰‹åŠ¨åˆ›å»ºä¹Ÿæ²¡æœ‰é—®é¢˜

å®‰è£…ä¾èµ–
```
commander  inquirer  chalk  ora  download-git-repo
```


### 2

æ–°å»ºä¸€ä¸ª bin æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ bin ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª xdj.js æ–‡ä»¶ï¼Œå¹¶å†™ä¸Šï¼š
```
#!/usr/bin/env node
console.log('hello,my first cli');
```

è¿™ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬æ•´ä¸ªè„šæ‰‹æ¶çš„å…¥å£æ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨ node ./bin/xr è¿è¡Œä¸€ä¸‹ï¼Œå°±èƒ½åœ¨æ§åˆ¶å°æ‰“å°å‡º helloï¼Œ

è¿™é‡Œè¦æ³¨æ„å¼€å¤´çš„ #!/usr/bin/env node è¿™ä¸ªè¯­å¥å¿…é¡»åŠ ä¸Šï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©ç³»ç»Ÿçœ‹åˆ°è¿™ä¸€è¡Œçš„æ—¶å€™ï¼Œä¼šæ²¿ç€è¯¥è·¯å¾„å»æŸ¥æ‰¾ node å¹¶æ‰§è¡Œï¼Œä¸»è¦æ˜¯ä¸ºäº†å…¼å®¹ Mac ï¼Œç¡®ä¿å¯æ‰§è¡Œã€‚

æˆ‘ä»¬æ¥ä¸°å¯Œä¸€ä¸‹ xdj.js æ–‡ä»¶

```
#!/usr/bin/env node
const program = require('commander')

// å®šä¹‰å½“å‰ç‰ˆæœ¬
// å®šä¹‰ä½¿ç”¨æ–¹æ³•
// å®šä¹‰å››ä¸ªæŒ‡ä»¤
program
  .version(require('../package').version)
  .usage('<command> [options]')
  .command('add', 'add a new template')
  .command('delete', 'delete a template')
  .command('list', 'list all the templates')
  .command('init', 'generate a new project from a template')
  
// è§£æå‘½ä»¤è¡Œå‚æ•°
program.parse(process.argv)

```


å½“ç„¶ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—æ¯æ¬¡è¾“å…¥ node ./bin/xr è¿™ä¸ªå‘½ä»¤æœ‰ç‚¹éº»çƒ¦ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ package.json é‡Œé¢å†™å…¥å·²ä¸‹å†…å®¹ï¼š

```
"bin": {
    "xdj": "bin/xdj.js"
}
```
å…¶ä¸­ xdj æ˜¯éœ€è¦æ‰§è¡Œçš„å‘½ä»¤åï¼Œbin/xdj.js æ˜¯å‘½ä»¤æ‰€è°ƒç”¨çš„æ–‡ä»¶


ç„¶ååœ¨æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm linkï¼ˆå°±æ˜¯æŠŠå‘½ä»¤æŒ‚è½½åˆ°å…¨å±€çš„æ„æ€ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬æ¯æ¬¡åªè¦è¾“å…¥ xdjï¼Œå°±å¯ä»¥ç›´æ¥è¿è¡Œäº†ï¼Œso coolï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š
```
D:\web\test\xdj-cli>xdj
Usage: xdj <command> [options]

Options:
  -V, --version  output the version number
  -h, --help     output usage information

Commands:
  add            add a new template
  delete         delete a template
  list           list all the templates
  init           generate a new project from a template
  help [cmd]     display help for [cmd]
```

