



# 包与 NPM

1. 包
Nodejs 中除了它自己提供的核心模块外，我们可以自定义模块，也可以使用第三方的模块。

Nodejs 中第三方模块由包组成，可以通过包来对一组具有相互依赖关系的模块进行统一管理

完全符合 CommonJs 规范的包目录一般包含如下这些文件。
• package.json :包描述文件。
• bin :用于存放可执行二进制文件的目录。
• lib :用于存放 JavaScript 代码的目录。
• doc :用于存放文档的目录。


2. NPM 介绍
npm 是世界上最大的开放源代码的生态系统。

我们可以通过 npm 下载各种各样的包，这些源代码（包）我们可以在 https://www.npmjs.com 找到。

npm 是随同 NodeJS 一起安装的包管理工具，能解决 NodeJS 代码部署上的很多问题，

常见的使用场景有以下几种：
•允许用户从 NPM 服务器下载别人编写的第三方包到本地使用。(silly-datetime)
•允许用户从 NPM 服务器下载并安装别人编写的命令行程序(工具)到本地使用。（supervisor）
•允许用户将自己编写的包或命令行程序上传到 NPM 服务器供别人使用。



## 模块的安装过程

总结一下，Node模块的安装过程是这样的。

1. 发出npm install命令

2. npm 向 registry 查询模块压缩包的网址

3. 下载压缩包，存放在~/.npm目录

4. 解压压缩包到当前项目的node_modules目录

注意，一个模块安装以后，本地其实保存了两份。一份是~/.npm目录下的压缩包，另一份是node_modules目录下解压后的代码。

但是，运行npm install的时候，只会检查node_modules目录，而不会检查~/.npm目录。也就是说，如果一个模块在～/.npm下有压缩包，但是没有安装在node_modules目录中，npm 依然会从远程仓库下载一次新的压缩包。

这种行为固然可以保证总是取得最新的代码，但有时并不是我们想要的。最大的问题是，它会极大地影响安装速度。即使某个模块的压缩包就在缓存目录中，也要去远程仓库下载，这怎么可能不慢呢？

另外，有些场合没有网络（比如飞机上），但是你想安装的模块，明明就在缓存目录之中，这时也无法安装。


